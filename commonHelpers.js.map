{"version":3,"file":"commonHelpers.js","sources":["../src/js/images-api.js","../src/js/templates.js","../src/js/toaster.js","../src/js/index.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '27839370-99dd6ddd44ecd058cc6f2562b';\nconst BASE_URL = 'https://pixabay.com/api/';\n\naxios.defaults.baseURL = BASE_URL;\n\nclass ImagesAPI {\n  constructor() {\n    this.searchQuery = '';\n    this.page = 1;\n  }\n\n  async fetchPictures() {\n    axios.defaults.params = {\n      key: API_KEY,\n      q: this.searchQuery,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 40,\n      page: this.page,\n    };\n\n    const { data } = await axios.get();\n    this.incrementPage();\n    return { ...data, page: this.page };\n  }\n\n  incrementPage() {\n    this.page += 1;\n  }\n\n  resetPage() {\n    this.page = 1;\n  }\n\n  get query() {\n    return this.searchQuery;\n  }\n\n  set query(newQuery) {\n    this.searchQuery = newQuery;\n  }\n}\n\nexport default ImagesAPI;\n","const galleryMarkup = array => {\n  return array\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <a href=\"${largeImageURL}\" class=\"photo-card\" data-caption=\"${tags}\">\n        <img class=\"photo\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        <div class=\"info\">\n          <div class=\"info-item\">\n            <p class=\"info-title\">Likes</p>\n            <p>${likes}</p>\n          </div>\n          <div class=\"info-item\">\n            <p class=\"info-title\">Views</p>\n            <p>${views}</p>\n          </div>\n          <div class=\"info-item\">\n            <p class=\"info-title\">Comments</p>\n            <p>${comments}</p>\n          </div>\n          <div class=\"info-item\">\n            <p class=\"info-title\">Downloads</p>\n            <p>${downloads}</p>\n          </div>\n        </div>\n      </a>\n      `\n    )\n    .join('');\n};\n\nexport { galleryMarkup };\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\niziToast.settings({\n  zindex: 999,\n  timeout: 5000,\n  resetOnHover: true,\n  position: 'bottomCenter',\n  transitionIn: 'flipInX',\n  transitionOut: 'flipOutX',\n});\n\nfunction showError(message) {\n  iziToast.show({\n    backgroundColor: '#E38359',\n    message,\n  });\n}\n\nfunction showWarning(message) {\n  iziToast.show({\n    backgroundColor: '#E1CB10',\n    message,\n  });\n}\n\nfunction showSuccess(message) {\n  iziToast.show({\n    backgroundColor: '#87D662',\n    message,\n  });\n}\n\nexport { showError, showWarning, showSuccess };\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport ImagesAPI from './images-api';\nimport { galleryMarkup } from './templates';\nimport { showError, showSuccess } from './toaster';\nconst imagesAPI = new ImagesAPI();\n\nconst elements = {\n  search: document.querySelector('#search-form'),\n  gallery: document.querySelector('.gallery'),\n  guard: document.querySelector('.js-guard'),\n};\n\nelements.search.addEventListener('submit', handleSearch);\n\nconst options = {\n  root: null,\n  rootMargin: '300px',\n  threshold: 1.0,\n};\nconst observer = new IntersectionObserver(handleLoadMore, options);\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  // captionSelector: 'self',\n  // captionsData: 'data-caption',\n});\n\nasync function handleSearch(event) {\n  event.preventDefault();\n  const searchQuery = event.target.elements.searchQuery.value.trim();\n\n  if (!searchQuery) {\n    return;\n  }\n\n  elements.gallery.innerHTML = '';\n  imagesAPI.query = searchQuery;\n  imagesAPI.resetPage();\n  observer.unobserve(elements.guard);\n\n  try {\n    const { hits, totalHits } = await imagesAPI.fetchPictures();\n\n    if (!totalHits) {\n      showError(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n    } else {\n      renderGallery(hits);\n      showSuccess(`Hooray! We found ${totalHits} images.`);\n      if (totalHits > 40)\n        setTimeout(() => {\n          observer.observe(elements.guard);\n        }, 1000);\n    }\n  } catch (err) {\n    console.log(err);\n    showError('Something went wrong :(');\n  }\n}\n\nasync function handleLoadMore(entries) {\n  if (entries[0]?.isIntersecting ?? false) {\n    console.log(entries[0]);\n    try {\n      const { hits, totalHits, page } = await imagesAPI.fetchPictures();\n\n      renderGallery(hits);\n      showSuccess(`Hooray! We found ${totalHits} images.`);\n      if (page > Math.ceil(totalHits / 40)) observer.unobserve(elements.guard);\n    } catch (err) {\n      console.log(err);\n      showError('Something went wrong :(');\n    }\n  }\n}\n\nfunction renderGallery(array) {\n  elements.gallery.insertAdjacentHTML('beforeend', galleryMarkup(array));\n  lightbox.refresh();\n}\n"],"names":["API_KEY","BASE_URL","axios","ImagesAPI","data","newQuery","galleryMarkup","array","webformatURL","largeImageURL","tags","likes","views","comments","downloads","iziToast","showError","message","showSuccess","imagesAPI","elements","handleSearch","options","observer","handleLoadMore","lightbox","SimpleLightbox","event","searchQuery","hits","totalHits","renderGallery","err","entries","_a","page"],"mappings":"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"}