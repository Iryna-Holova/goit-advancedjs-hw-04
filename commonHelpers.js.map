{"version":3,"file":"commonHelpers.js","sources":["../src/js/templates.js","../src/js/toaster.js","../src/js/images-api.js","../src/js/index.js"],"sourcesContent":["const galleryMarkup = array => {\n  return array\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <a href=\"${largeImageURL}\" class=\"photo-card\" data-caption=\"${tags}\">\n        <img class=\"photo\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        <div class=\"info\">\n          <div class=\"info-item\">\n            <p class=\"info-title\">Likes</p>\n            <p>${likes}</p>\n          </div>\n          <div class=\"info-item\">\n            <p class=\"info-title\">Views</p>\n            <p>${views}</p>\n          </div>\n          <div class=\"info-item\">\n            <p class=\"info-title\">Comments</p>\n            <p>${comments}</p>\n          </div>\n          <div class=\"info-item\">\n            <p class=\"info-title\">Downloads</p>\n            <p>${downloads}</p>\n          </div>\n        </div>\n      </a>\n      `\n    )\n    .join('');\n};\n\nexport { galleryMarkup };\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\niziToast.settings({\n  zindex: 999,\n  timeout: 5000,\n  resetOnHover: true,\n  position: 'bottomCenter',\n  transitionIn: 'flipInX',\n  transitionOut: 'flipOutX',\n});\n\nfunction showError(message) {\n  iziToast.show({\n    backgroundColor: '#E38359',\n    message,\n  });\n}\n\nfunction showWarning(message) {\n  iziToast.show({\n    backgroundColor: '#E1CB10',\n    message,\n  });\n}\n\nfunction showSuccess(message) {\n  iziToast.show({\n    backgroundColor: '#87D662',\n    message,\n  });\n}\n\nexport { showError, showWarning, showSuccess };\n","import axios from 'axios';\n\nconst API_KEY = '27839370-99dd6ddd44ecd058cc6f2562b';\nconst BASE_URL = 'https://pixabay.com/api/';\n\naxios.defaults.baseURL = BASE_URL;\n\n/**\n * Class representing the Images API.\n */\nclass ImagesAPI {\n\n  constructor() {\n    this.apiKey = API_KEY;\n    this.baseURL = BASE_URL;\n    this.searchQuery = '';\n    this.page = 1;\n  }\n\n  /**\n   * Fetch pictures based on the current search query and page.\n   * @returns {Promise<Object>} - A Promise that resolves to an object containing image data.\n   */\n  async fetchPictures() {\n    const { data } = await axios.get(this.baseURL, {\n      params: {\n        key: this.apiKey,\n        q: this.searchQuery,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 40,\n        page: this.page,\n      },\n    });\n    this.incrementPage();\n    return { ...data, page: this.page };\n  }\n\n  /**\n   * Increment the current page for pagination.\n   */\n  incrementPage() {\n    this.page += 1;\n  }\n\n  /**\n   * Reset the current page to 1.\n   */\n  resetPage() {\n    this.page = 1;\n  }\n\n  /**\n   * Get the current search query.\n   * @returns {string} - The current search query.\n   */\n  get query() {\n    return this.searchQuery;\n  }\n\n  /**\n   * Set a new search query.\n   * @param {string} newQuery - The new search query.\n   */\n  set query(newQuery) {\n    this.searchQuery = newQuery;\n  }\n}\n\nexport default ImagesAPI;\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { galleryMarkup } from './templates';\nimport { showError, showSuccess, showWarning } from './toaster';\nimport ImagesAPI from './images-api';\n\nconst elements = {\n  search: document.querySelector('#search-form'),\n  gallery: document.querySelector('.gallery'),\n  guard: document.querySelector('.js-guard'),\n};\n\nelements.search.addEventListener('submit', handleSearch);\n\nconst options = {\n  root: null,\n  rootMargin: '300px',\n  threshold: 1.0,\n};\nconst observer = new IntersectionObserver(handleLoadMore, options);\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionSelector: 'self',\n  captionsData: 'data-caption',\n});\n\nconst imagesAPI = new ImagesAPI();\n\nasync function handleSearch(event) {\n  event.preventDefault();\n  const searchQuery = event.target.elements.searchQuery.value.trim();\n\n  if (!searchQuery) {\n    return;\n  }\n\n  elements.gallery.innerHTML = '';\n  imagesAPI.query = searchQuery;\n  imagesAPI.resetPage();\n  observer.unobserve(elements.guard);\n\n  try {\n    const { hits, totalHits } = await imagesAPI.fetchPictures();\n\n    if (!totalHits) {\n      showError(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n    } else {\n      renderGallery(hits);\n      showSuccess(`Hooray! We found ${totalHits} images.`);\n      if (totalHits > 40)\n        setTimeout(() => {\n          observer.observe(elements.guard);\n        }, 1000);\n    }\n  } catch (err) {\n    console.log(err);\n    showError('Something went wrong :(');\n  }\n}\n\nasync function handleLoadMore(entries) {\n  if (entries[0]?.isIntersecting ?? false) {\n    try {\n      const { hits, totalHits, page } = await imagesAPI.fetchPictures();\n      renderGallery(hits);\n\n      if (page > Math.ceil(totalHits / 40)) {\n        showWarning(\n          \"We're sorry, but you've reached the end of search results.\"\n        );\n        observer.unobserve(elements.guard);\n      }\n    } catch (err) {\n      console.log(err);\n      showError('Something went wrong :(');\n    }\n  }\n}\n\nfunction renderGallery(array) {\n  elements.gallery.insertAdjacentHTML('beforeend', galleryMarkup(array));\n  lightbox.refresh();\n}\n"],"names":["galleryMarkup","array","webformatURL","largeImageURL","tags","likes","views","comments","downloads","iziToast","showError","message","showWarning","showSuccess","API_KEY","BASE_URL","axios","ImagesAPI","data","newQuery","elements","handleSearch","options","observer","handleLoadMore","lightbox","SimpleLightbox","imagesAPI","event","searchQuery","hits","totalHits","renderGallery","err","entries","_a","page"],"mappings":"owBAAA,MAAMA,EAAgBC,GACbA,EACJ,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAY;AAAA,iBACKL,uCAAmDC;AAAA,kCAClCF,WAAsBE;AAAA;AAAA;AAAA;AAAA,iBAIvCC;AAAA;AAAA;AAAA;AAAA,iBAIAC;AAAA;AAAA;AAAA;AAAA,iBAIAC;AAAA;AAAA;AAAA;AAAA,iBAIAC;AAAA;AAAA;AAAA;AAAA,OAKZ,EACA,KAAK,EAAE,EChCZC,EAAS,SAAS,CAChB,OAAQ,IACR,QAAS,IACT,aAAc,GACd,SAAU,eACV,aAAc,UACd,cAAe,UACjB,CAAC,EAED,SAASC,EAAUC,EAAS,CAC1BF,EAAS,KAAK,CACZ,gBAAiB,UACjB,QAAAE,CACJ,CAAG,CACH,CAEA,SAASC,EAAYD,EAAS,CAC5BF,EAAS,KAAK,CACZ,gBAAiB,UACjB,QAAAE,CACJ,CAAG,CACH,CAEA,SAASE,EAAYF,EAAS,CAC5BF,EAAS,KAAK,CACZ,gBAAiB,UACjB,QAAAE,CACJ,CAAG,CACH,CC7BA,MAAMG,EAAU,qCACVC,EAAW,2BAEjBC,EAAM,SAAS,QAAUD,EAKzB,MAAME,CAAU,CAEd,aAAc,CACZ,KAAK,OAASH,EACd,KAAK,QAAUC,EACf,KAAK,YAAc,GACnB,KAAK,KAAO,CACb,CAMD,MAAM,eAAgB,CACpB,KAAM,CAAE,KAAAG,CAAI,EAAK,MAAMF,EAAM,IAAI,KAAK,QAAS,CAC7C,OAAQ,CACN,IAAK,KAAK,OACV,EAAG,KAAK,YACR,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAM,KAAK,IACZ,CACP,CAAK,EACD,YAAK,cAAa,EACX,CAAE,GAAGE,EAAM,KAAM,KAAK,IAAI,CAClC,CAKD,eAAgB,CACd,KAAK,MAAQ,CACd,CAKD,WAAY,CACV,KAAK,KAAO,CACb,CAMD,IAAI,OAAQ,CACV,OAAO,KAAK,WACb,CAMD,IAAI,MAAMC,EAAU,CAClB,KAAK,YAAcA,CACpB,CACH,CC9DA,MAAMC,EAAW,CACf,OAAQ,SAAS,cAAc,cAAc,EAC7C,QAAS,SAAS,cAAc,UAAU,EAC1C,MAAO,SAAS,cAAc,WAAW,CAC3C,EAEAA,EAAS,OAAO,iBAAiB,SAAUC,CAAY,EAEvD,MAAMC,EAAU,CACd,KAAM,KACN,WAAY,QACZ,UAAW,CACb,EACMC,EAAW,IAAI,qBAAqBC,EAAgBF,CAAO,EAE3DG,EAAW,IAAIC,EAAe,aAAc,CAChD,gBAAiB,OACjB,aAAc,cAChB,CAAC,EAEKC,EAAY,IAAIV,EAEtB,eAAeI,EAAaO,EAAO,CACjCA,EAAM,eAAc,EACpB,MAAMC,EAAcD,EAAM,OAAO,SAAS,YAAY,MAAM,OAE5D,GAAKC,EAIL,CAAAT,EAAS,QAAQ,UAAY,GAC7BO,EAAU,MAAQE,EAClBF,EAAU,UAAS,EACnBJ,EAAS,UAAUH,EAAS,KAAK,EAEjC,GAAI,CACF,KAAM,CAAE,KAAAU,EAAM,UAAAC,CAAS,EAAK,MAAMJ,EAAU,cAAa,EAEpDI,GAKHC,EAAcF,CAAI,EAClBjB,EAAY,oBAAoBkB,WAAmB,EAC/CA,EAAY,IACd,WAAW,IAAM,CACfR,EAAS,QAAQH,EAAS,KAAK,CAChC,EAAE,GAAI,GATTV,EACE,0EACR,CASG,OAAQuB,EAAP,CACA,QAAQ,IAAIA,CAAG,EACfvB,EAAU,yBAAyB,CACpC,EACH,CAEA,eAAec,EAAeU,EAAS,OACrC,KAAIC,EAAAD,EAAQ,KAAR,YAAAC,EAAY,iBAAkB,GAChC,GAAI,CACF,KAAM,CAAE,KAAAL,EAAM,UAAAC,EAAW,KAAAK,CAAM,EAAG,MAAMT,EAAU,gBAClDK,EAAcF,CAAI,EAEdM,EAAO,KAAK,KAAKL,EAAY,EAAE,IACjCnB,EACE,4DACV,EACQW,EAAS,UAAUH,EAAS,KAAK,EAEpC,OAAQa,EAAP,CACA,QAAQ,IAAIA,CAAG,EACfvB,EAAU,yBAAyB,CACpC,CAEL,CAEA,SAASsB,EAAc/B,EAAO,CAC5BmB,EAAS,QAAQ,mBAAmB,YAAapB,EAAcC,CAAK,CAAC,EACrEwB,EAAS,QAAO,CAClB"}